import{e as d,f as n,n as o,g as m}from"#entry";import"./BXsWsSdj.js";import"./CdQP9W9V.js";const g=d(async s=>{let e,i;const a=useAdminStore();if(s.path==="/admin/login")return;const r=([e,i]=n(()=>a.restoreSession()),e=await e,i(),e);if(!a.isAuthenticated&&!r)return o("/admin/login");if(!a.isSessionValid)return[e,i]=n(()=>a.logout()),await e,i(),o("/admin/login");const t={"/admin/dashboard":"admin.dashboard.view","/admin/telemetry":"admin.telemetry.view","/admin/broadcast":"admin.broadcast.manage","/admin/todos":"admin.todos.manage","/admin/system":"admin.system.monitor"}[s.path];if(t&&!a.hasPermission(t))throw[e,i]=n(()=>a.logAction("unauthorized_access","admin_route",{path:s.path,requiredPermission:t})),await e,i(),m({statusCode:403,statusMessage:"Access Denied: Insufficient permissions"})});export{g as default};
